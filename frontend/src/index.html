<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>News Crawler</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div id="app">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1 class="app-title">
                    <i class="fas fa-newspaper"></i>
                    News Crawler
                </h1>
                <div class="header-actions">
                    <button id="newTaskBtn" class="btn btn-primary">
                        <i class="fas fa-plus"></i>
                        New Task
                    </button>
                    <button id="settingsBtn" class="btn btn-secondary">
                        <i class="fas fa-cog"></i>
                        Settings
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Sidebar -->
            <aside class="sidebar">
                <nav class="nav">
                    <ul class="nav-list">
                        <li class="nav-item">
                            <a href="#dashboard" class="nav-link active" data-section="dashboard">
                                <i class="fas fa-tachometer-alt"></i>
                                Dashboard
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#tasks" class="nav-link" data-section="tasks">
                                <i class="fas fa-tasks"></i>
                                Tasks
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#articles" class="nav-link" data-section="articles">
                                <i class="fas fa-newspaper"></i>
                                Articles
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#sources" class="nav-link" data-section="sources">
                                <i class="fas fa-rss"></i>
                                RSS Sources
                            </a>
                        </li>
                    </ul>
                </nav>
            </aside>

            <!-- Content Area -->
            <div class="content">
                <!-- Dashboard Section -->
                <section id="dashboard" class="section active">
                    <div class="section-header">
                        <h2>Dashboard</h2>
                        <div class="section-actions">
                            <button id="refreshDashboard" class="btn btn-outline">
                                <i class="fas fa-sync-alt"></i>
                                Refresh
                            </button>
                        </div>
                    </div>
                    
                    <div class="dashboard-grid">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-tasks"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="totalTasks">0</h3>
                                <p>Total Tasks</p>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-newspaper"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="totalArticles">0</h3>
                                <p>Total Articles</p>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="runningTasks">0</h3>
                                <p>Running Tasks</p>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-rss"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="activeSources">0</h3>
                                <p>Active Sources</p>
                            </div>
                        </div>
                    </div>

                    <div class="recent-tasks">
                        <h3>Recent Tasks</h3>
                        <div id="recentTasksList" class="task-list">
                            <!-- Recent tasks will be loaded here -->
                        </div>
                    </div>
                </section>

                <!-- Tasks Section -->
                <section id="tasks" class="section">
                    <div class="section-header">
                        <h2>Tasks</h2>
                        <div class="section-actions">
                            <button id="newTaskBtn2" class="btn btn-primary">
                                <i class="fas fa-plus"></i>
                                New Task
                            </button>
                            <button id="refreshTasks" class="btn btn-outline">
                                <i class="fas fa-sync-alt"></i>
                                Refresh
                            </button>
                        </div>
                    </div>
                    
                    <div class="filters">
                        <select id="statusFilter" class="filter-select">
                            <option value="">All Status</option>
                            <option value="pending">Pending</option>
                            <option value="running">Running</option>
                            <option value="completed">Completed</option>
                            <option value="failed">Failed</option>
                        </select>
                    </div>
                    
                    <div id="tasksList" class="task-list">
                        <!-- Tasks will be loaded here -->
                    </div>
                </section>

                <!-- Articles Section -->
                <section id="articles" class="section">
                    <div class="section-header">
                        <h2>Articles</h2>
                        <div class="section-actions">
                            <button id="refreshArticles" class="btn btn-outline">
                                <i class="fas fa-sync-alt"></i>
                                Refresh
                            </button>
                            <button id="exportArticles" class="btn btn-secondary">
                                <i class="fas fa-download"></i>
                                Export
                            </button>
                        </div>
                    </div>
                    
                    <div class="filters">
                        <input type="text" id="searchArticles" placeholder="Search articles..." class="filter-input">
                        <select id="sourceFilter" class="filter-select">
                            <option value="">All Sources</option>
                        </select>
                        <select id="taskFilter" class="filter-select">
                            <option value="">All Tasks</option>
                        </select>
                    </div>
                    
                    <div id="articlesList" class="articles-list">
                        <!-- Articles will be loaded here -->
                    </div>
                </section>

                <!-- Sources Section -->
                <section id="sources" class="section">
                    <div class="section-header">
                        <h2>RSS Sources</h2>
                        <div class="section-actions">
                            <button id="addSourceBtn" class="btn btn-primary">
                                <i class="fas fa-plus"></i>
                                Add Source
                            </button>
                            <button id="refreshSources" class="btn btn-outline">
                                <i class="fas fa-sync-alt"></i>
                                Refresh
                            </button>
                        </div>
                    </div>
                    
                    <div id="sourcesList" class="sources-list">
                        <!-- Sources will be loaded here -->
                    </div>
                </section>
            </div>
        </main>

        <!-- Modals -->
        <!-- New Task Modal -->
        <div id="newTaskModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Create New Crawl Task</h3>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="newTaskForm">
                        <div class="form-group">
                            <label for="taskQuery">Search Query *</label>
                            <input type="text" id="taskQuery" name="taskQuery" required placeholder="Enter keywords to search for...">
                        </div>
                        
                        <div class="form-group">
                            <label for="taskSince">Since Date</label>
                            <input type="date" id="taskSince" name="taskSince">
                        </div>
                        
                        <div class="form-group">
                            <label for="taskLimit">Article Limit</label>
                            <input type="number" id="taskLimit" name="taskLimit" value="50" min="1" max="1000">
                        </div>
                        
                        <div class="form-group">
                            <label for="customFeeds">Custom RSS Feeds (optional)</label>
                            <textarea id="customFeeds" name="customFeeds" placeholder="Enter RSS feed URLs, one per line"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary modal-cancel">Cancel</button>
                    <button type="submit" form="newTaskForm" class="btn btn-primary">Create Task</button>
                </div>
            </div>
        </div>

        <!-- Article Detail Modal -->
        <div id="articleModal" class="modal">
            <div class="modal-content large">
                <div class="modal-header">
                    <h3 id="articleTitle">Article Title</h3>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="article-meta">
                        <span class="article-source" id="articleSource">Source</span>
                        <span class="article-date" id="articleDate">Date</span>
                        <a href="#" id="articleUrl" target="_blank" class="article-link">
                            <i class="fas fa-external-link-alt"></i>
                            View Original
                        </a>
                    </div>
                    <div class="article-summary" id="articleSummary">
                        <!-- Summary will be loaded here -->
                    </div>
                    <div class="article-content" id="articleContent">
                        <!-- Full content will be loaded here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary modal-cancel">Close</button>
                    <button type="button" class="btn btn-primary" id="regenerateSummary">
                        <i class="fas fa-sync-alt"></i>
                        Regenerate Summary
                    </button>
                </div>
            </div>
        </div>

        <!-- Add Source Modal -->
        <div id="addSourceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Add RSS Source</h3>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="addSourceForm">
                        <div class="form-group">
                            <label for="sourceName">Source Name *</label>
                            <input type="text" id="sourceName" name="sourceName" required placeholder="e.g., CNN News">
                        </div>
                        
                        <div class="form-group">
                            <label for="sourceUrl">RSS URL *</label>
                            <input type="url" id="sourceUrl" name="sourceUrl" required placeholder="https://example.com/rss">
                        </div>
                        
                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="supportsQuery" name="supportsQuery">
                                <span class="checkmark"></span>
                                Supports query parameters (use {query} placeholder)
                            </label>
                        </div>
                        
                        <div class="form-group">
                            <label for="sourcePriority">Priority</label>
                            <input type="number" id="sourcePriority" name="sourcePriority" value="0" min="0" max="100">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary modal-cancel">Cancel</button>
                    <button type="submit" form="addSourceForm" class="btn btn-primary">Add Source</button>
                </div>
            </div>
        </div>

        <!-- Settings Modal -->
        <div id="settingsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Settings</h3>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="settings-section">
                        <h4>Summary Generation</h4>
                        <div class="form-group">
                            <label for="summaryStrategy">Strategy</label>
                            <select id="summaryStrategy">
                                <option value="rss_first">RSS First (use RSS summary if available)</option>
                                <option value="ai_generated">AI Generated (use AI model)</option>
                                <option value="hybrid">Hybrid (combine RSS and AI)</option>
                                <option value="simple">Simple (extract from text)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="settings-section">
                        <h4>API Configuration</h4>
                        <div class="form-group">
                            <label for="apiBaseUrl">API Base URL</label>
                            <input type="url" id="apiBaseUrl" value="http://localhost:8000">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary modal-cancel">Cancel</button>
                    <button type="button" class="btn btn-primary" id="saveSettings">Save Settings</button>
                </div>
            </div>
        </div>

        <!-- Loading Overlay -->
        <div id="loadingOverlay" class="loading-overlay">
            <div class="loading-spinner">
                <i class="fas fa-spinner fa-spin"></i>
                <p>Loading...</p>
            </div>
        </div>

        <!-- Toast Notifications -->
        <div id="toastContainer" class="toast-container"></div>
    </div>

    <script src="api.js"></script>
    <script src="app.js"></script>
</body>
</html>
